--DROPPING TABLES IF THEY EXIST AND CASCADE TO DROP FROM THE METADATA
DROP TABLE "D_CUSTOMERS" CASCADE CONSTRAINTS;
DROP TABLE "D_PRODUCTS" CASCADE CONSTRAINTS;
DROP TABLE "D_STORES" CASCADE CONSTRAINTS;
DROP TABLE "D_SUPPLIERS" CASCADE CONSTRAINTS;
DROP TABLE "D_TIME" CASCADE CONSTRAINTS;
DROP TABLE "W_FACTS" CASCADE CONSTRAINTS;

--CREATE TABLES FOR DATABASE FOR ASSIGNMENT2 BY ROBSON CHIAMBIRO

--CREATE A CUSTOMERS DIMENSION
CREATE TABLE D_CUSTOMERS(
	CUSTOMER_ID VARCHAR2(5),
	CUSTOMER_NAME VARCHAR2(30) NOT NULL,
CONSTRAINT NW_CUSTOMERS_PK PRIMARY KEY (CUSTOMER_ID) ENABLE
);

--CREATING A PRODUCTS DIMENSION
CREATE TABLE D_PRODUCTS(
	PRODUCT_ID VARCHAR2(8),
	PRODUCT_NAME VARCHAR2(30) NOT NULL,
CONSTRAINT NW_PRODUCTS_PK PRIMARY KEY (PRODUCT_ID) ENABLE
);

--CREATING A STORES DIMENSION
CREATE TABLE D_STORES(
	STORE_ID VARCHAR2(4),
	STORE_NAME VARCHAR2(30) NOT NULL,
CONSTRAINT NW_STORES_PK PRIMARY KEY (STORE_ID) ENABLE
);

--CREATING SUPPLIERS DIMENSION
CREATE TABLE D_SUPPLIERS(
	SUPPLIER_ID VARCHAR2(5),
	SUPPLIER_NAME VARCHAR2(30) NOT NULL,
CONSTRAINT NW_SUPPLIERS_PK PRIMARY KEY (SUPPLIER_ID) ENABLE
);

--CREATING TIME DIMENSION
CREATE TABLE D_TIME(
	TIME_ID VARCHAR2(8),
	CAL_DATE DATE,
	CAL_DAY VARCHAR2(9),
	CAL_MONTH VARCHAR2(9),
	CAL_QUARTER VARCHAR2(1),
	CAL_YEAR NUMBER(4,0),
CONSTRAINT NW_TIME_PK PRIMARY KEY (TIME_ID) ENABLE
);

--CREATING THE FACT TABLE
CREATE TABLE W_FACTS(
	TRANSACTION_ID NUMBER(8,0),
	CUSTOMER_ID VARCHAR2(5),
	PRODUCT_ID VARCHAR2(8),
	STORE_ID VARCHAR2(4),
	SUPPLIER_ID VARCHAR2(5),
	TIME_ID VARCHAR2(8),
	QUANTITY NUMBER (2,0) NOT NULL,
	PRICE NUMBER(5,2) NOT NULL,
	SALE NUMBER(6,2) NOT NULL,
CONSTRAINT NW_TRANSACTIONS_PK PRIMARY KEY (TRANSACTION_ID) ENABLE,
CONSTRAINT NW_CUSTOMERS_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES D_CUSTOMERS(CUSTOMER_ID),
CONSTRAINT NW_PRODUCTS_FK FOREIGN KEY (PRODUCT_ID) REFERENCES D_PRODUCTS(PRODUCT_ID),
CONSTRAINT NW_STORES_FK FOREIGN KEY (STORE_ID) REFERENCES D_STORES(STORE_ID),
CONSTRAINT NW_SUPPLIERS_FK FOREIGN KEY (SUPPLIER_ID) REFERENCES D_SUPPLIERS(SUPPLIER_ID),
CONSTRAINT NW_TIME_FK FOREIGN KEY (TIME_ID) REFERENCES D_TIME(TIME_ID)
);
	




	
	
